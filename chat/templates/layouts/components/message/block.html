{% load static %}
{% load debug %}
{% load markdown %}
{% load i18n %}
{% load humanize %}
{% load humanize_plus %}

<div
    {% with author=message.author %}
        class="message
{% if author == request.user %}message-me {% endif %}
{% if message.same_previous_author %}no-radius-top {% endif %}
{% if message.same_next_author %}no-radius-bottom {% endif %}
"
    {% endwith %}
        id="{{ message.id }}">
    <img class="messageAvatar"
         src="
{% if message.author.avatar.url %}
{{ message.author.avatar.url }}
{% else %}
{% static "images/icons/circle_user.svg" %}
{% endif %}
" alt="" loading="lazy">
    <div class="messageHeader">
        <span class="username">
            {{ message.author }}
        </span>

        <span class="timestamp">
            <time title="{{ message.created_at }}" aria-label="{{ message.created_at|naturaltime }}"
                  datetime="{{ message.created_at|date:"c" }}">
                {{ message.created_at|naturaltime }}
            </time>
        </span>
    </div>
    <div class="messageContent">
        <div class="content">
            {{ message.content }}
        </div>

        {% with attachments=message.attachments.all %}
            {% if attachments %}
                <div class="attachments">
                    <ul>
                        {% for attachment in attachments %}
                            <li>
                                <a target="_blank" class="link" href="{{ attachment.file.url }}">
                                    {{ attachment.filename|bold_extension }} {% trans "file" %}
                                    <span>({{ attachment.file.size|naturalsize }})</span>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}
        {% endwith %}
    </div>


    {% if message.author == request.user %}
        <div class="messageAction">
            <form action="">
                <button type="submit">
                    x
                </button>
            </form>
        </div>
    {% endif %}
</div>
